# **Survey Container** 
![SurveyContainer](https://github.com/FernandoMejiaDev/Survey-Container/blob/main/Img-Readme/SurveyContainer.png)

> [!important]
> Este repositorio contiene el cÃ³digo fuente y desarrollo del paquete NPM survey container.
> Si estÃ¡s buscando cÃ³mo utilizar este paquete en un proyecto, consulta el repositorio de demo donde se muestra cÃ³mo instalarlo y utilizarlo como dependencia 
> Este repositorio estÃ¡ enfocado en el desarrollo y mantenimiento del paquete. Si lo clonas, obtendrÃ¡s el entorno de desarrollo del mismo. 
> Se separaron ambos repositorios (desarrollo y demo) para evitar confusiones entre contribuir al paquete y simplemente consumirlo como dependencia.

[![GITHUB](https://img.shields.io/static/v1?message=DocumentaciÃ³n&logo=Github&label=&color=22262A&logoColor=white&labelColor=&style=for-the-badge)](https://github.com/FernandoMejiaDev/Survey-Container-Documentation)

# ğŸ“¦ Survey Container

**Survey Container** es una soluciÃ³n completa desarrollada como parte de una prueba tÃ©cnica para construir un sistema de encuestas internas modular, reutilizable y escalable. Este proyecto incluye:

- Un SDK frontend en React + TypeScript (`/sdk`)
- Un backend en Node.js + Express + TypeScript (`/backend`)
- Una API funcional para gestionar encuestas, respuestas y mÃ©tricas
- Una app de demostraciÃ³n (`/demo-app`) que integra el SDK

## ğŸ§  Â¿QuÃ© es Survey Container?

Survey Container es un sistema de encuestas interno pensado para integrarse fÃ¡cilmente en diferentes aplicaciones. EstÃ¡ compuesto por un paquete npm exportable (`<SurveyWidget />`) y una API para manejo de datos. Fue creado con TypeScript en todos sus componentes, siguiendo principios de modularidad y escalabilidad.

### ğŸš€ Â¿QuÃ© necesidad resuelve?

- Permite a empresas recolectar feedback interno de forma Ã¡gil.
- Su diseÃ±o modular permite integrarlo fÃ¡cilmente en mÃºltiples entornos frontend.
- Ofrece una API clara y tipada para obtener resultados de encuestas y mÃ©tricas.

### âš™ï¸ TecnologÃ­as utilizadas

<div align="left">

![typescript](https://img.shields.io/static/v1?message=typescript&logo=typescript&label=&color=3178C6&logoColor=white&labelColor=&style=for-the-badge)
![react](https://img.shields.io/static/v1?message=react&logo=react&label=&color=61DAFB&logoColor=black&labelColor=&style=for-the-badge)
![nodedotjs](https://img.shields.io/static/v1?message=node&logo=nodedotjs&label=&color=5FA04E&logoColor=white&labelColor=&style=for-the-badge)
![express](https://img.shields.io/static/v1?message=express&logo=express&label=&color=000000&logoColor=white&labelColor=&style=for-the-badge)
![sqlite](https://img.shields.io/static/v1?message=sqlite&logo=sqlite&label=&color=003B57&logoColor=white&labelColor=&style=for-the-badge)

</div>

### ğŸ§ª CÃ³mo probar Survey-Container
- clona el repositorio
- instala las dependencias de cada carpeta

**Backend**

```
cd backend && npm install
```

**demo-app** 

```
cd demo-app && npm install
```

**sdk**

```
cd sdk && npm install
```
---

## ğŸ“ Estructura del proyecto

<details>
<summary>ğŸ“‚ backend</summary>

El backend estÃ¡ desarrollado con **Node.js**, usando el framework **Express** y escrito completamente en **TypeScript**. Utiliza **SQLite** como sistema de base de datos local y **Prisma** como ORM para el manejo de datos.


## âš™ï¸ TecnologÃ­as usadas

<div align="left">

![typescript](https://img.shields.io/static/v1?message=typescript&logo=typescript&label=&color=3178C6&logoColor=white&labelColor=&style=for-the-badge)
![nodedotjs](https://img.shields.io/static/v1?message=node&logo=nodedotjs&label=&color=5FA04E&logoColor=white&labelColor=&style=for-the-badge)
![express](https://img.shields.io/static/v1?message=express&logo=express&label=&color=000000&logoColor=white&labelColor=&style=for-the-badge)
![sqlite](https://img.shields.io/static/v1?message=sqlite&logo=sqlite&label=&color=003B57&logoColor=white&labelColor=&style=for-the-badge)
![prisma](https://img.shields.io/static/v1?message=prisma&logo=prisma&label=&color=2D3748&logoColor=white&labelColor=&style=for-the-badge)

</div>

### ğŸ“¦ Estructura general

```
/backend
â”‚
â”œâ”€â”€ prisma/
â”‚ â””â”€â”€ schema.prisma â† DefiniciÃ³n del modelo de la base de datos
â”‚
â”œâ”€â”€ src/
â”‚ â”œâ”€â”€ controllers/ â† MÃ©todos para manejar encuestas, respuestas y mÃ©tricas
â”‚ â”œâ”€â”€ models/ â† (Si tienes interfaces o tipos definidos)
â”‚ â”œâ”€â”€ prisma/
â”‚ â”‚ â””â”€â”€ client.ts â† Inicializa la conexiÃ³n con Prisma
â”‚ â”œâ”€â”€ routes/ â† Define rutas para surveys, responses y mÃ©tricas
â”‚ â””â”€â”€ index.ts â† Archivo principal para levantar el servidor
â”‚
â”œâ”€â”€ .env â† Variables de entorno
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

> Las carpetas `dist/` y `node_modules/` se excluyen porque se generan automÃ¡ticamente al compilar y al instalar dependencias.

### ğŸ§  Â¿QuÃ© es `prisma/`?

La carpeta `prisma/` contiene el archivo `schema.prisma`, donde se define el modelo de la base de datos.  
AquÃ­ se declaran las **tablas** (o modelos) como `Survey`, `Question`, `Response`, etc., que luego Prisma usa para generar el acceso a la base de datos.

TambiÃ©n puedes correr el siguiente comando para abrir una interfaz visual de la base de datos:

```
npx prisma studio
```

### ğŸ› ï¸ ConfiguraciÃ³n de la base de datos

Para configurar la base de datos con SQLite, asegÃºrate de tener el archivo schema.prisma definido. Luego:

1. Entra a la carpeta backend: 

```
cd backend 
```

2. Instala dependencias:

```
npm install
```

3. Genera el cliente Prisma y crea la base de datos:

```
npx prisma generate
npx prisma db push
```

Esto crearÃ¡ automÃ¡ticamente el archivo dev.db (base de datos SQLite) basado en el esquema.

4. Para ver tu base de datos ve a Prisma Studio:

```
npx prisma studio
```

### ğŸš€ Iniciar el servidor

- Recuerd que debes entrar a la carpeta backend para inicar el servidor

```
cd backend 
```

- inicia el servidor 

```
npm run dev
```

### ğŸŒ Rutas disponibles
Estas rutas estÃ¡n definidas dentro de la carpeta `src/routes` y cada una se conecta con su respectivo controlador (`src/controllers`):

| **MÃ©todo** | **Ruta**                  | **DescripciÃ³n**                         |
|:----------:|:--------------------------|:----------------------------------------|
| GET        | `/api/surveys/:id`        | Obtener una encuesta por su ID          |
| POST       | `/api/responses`          | Enviar respuestas de encuesta           |
| GET        | `/api/metrics/:surveyId`  | Ver mÃ©tricas agrupadas por pregunta     |


### ğŸ“‚ ExplicaciÃ³n por carpetas
- `controllers/`: AquÃ­ se encuentran las funciones que manejan la lÃ³gica de cada endpoint, como obtener encuestas, registrar respuestas y calcular mÃ©tricas.
- `routes/`: Define las rutas del API y las conecta con los controladores correspondientes.
- `prisma/client.ts`: Archivo que crea y exporta una instancia de PrismaClient. Se importa en los controladores para acceder a la base de datos.
- `index.ts`: Archivo principal que levanta el servidor Express y configura middlewares bÃ¡sicos.

</details>

<details>
<summary>ğŸ“‚ demo-app</summary>

## ğŸ¯ Â¿QuÃ© es `demo-app`?

La carpeta `demo-app` contiene una aplicaciÃ³n web desarrollada con **React**, **TypeScript** y **Vite**.  
Esta aplicaciÃ³n sirve como demostraciÃ³n de cÃ³mo utilizar el componente `SurveyWidget` del SDK, mostrando su funcionamiento en distintos escenarios de uso real.

---

## âš™ï¸ TecnologÃ­as usadas

<div align="left">

![typescript](https://img.shields.io/static/v1?message=typescript&logo=typescript&label=&color=3178C6&logoColor=white&labelColor=&style=for-the-badge)
![react](https://img.shields.io/static/v1?message=react&logo=react&label=&color=61DAFB&logoColor=black&labelColor=&style=for-the-badge)
![vite](https://img.shields.io/static/v1?message=vite&logo=vite&label=&color=646CFF&logoColor=white&labelColor=&style=for-the-badge)
![reactrouter](https://img.shields.io/static/v1?message=React-Router-DOM&logo=reactrouter&label=&color=CA4245&logoColor=white&labelColor=&style=for-the-badge)

</div>

> ğŸ¨ Estilos personalizados con CSS (sin Tailwind por compatibilidad con el SDK)

## ğŸš€ Â¿CÃ³mo iniciar el proyecto?

Primero, asegÃºrate de haber instalado las dependencias:

```
cd demo-app
npm install
```

Luego, para iniciar el servidor en desarrollo:

```
npm run dev
```

## ğŸ§­ NavegaciÃ³n y rutas
La lÃ³gica de rutas estÃ¡ definida en src/main.tsx, y utiliza react-router-dom. Las rutas disponibles son:

| **Ruta** | **Componente**                  | **DescripciÃ³n**                         |
|:----------:|:--------------------------|:----------------------------------------|
| /                   | `MetricsViewer`  | PÃ¡gina inicial: muestra todas las encuestas disponibles en la base de datos  |
| /app                | `App`            | PÃ¡gina para ingresar manualmente el ID de una encuesta                       |
| /survey/:surveyId   | `App`            | PÃ¡gina para responder la encuesta seleccionada                               |


El enrutamiento se define asÃ­ en `main.tsx`:

```
<BrowserRouter>
  <Routes>
    <Route path="/" element={<MetricsViewer />} />
    <Route path="/app" element={<App />} />
    <Route path="/survey/:surveyId" element={<SurveyPage />} />
  </Routes>
</BrowserRouter>
```

### ğŸ§ª Funcionalidad principal

- Al iniciar la aplicaciÃ³n, se listan todas las encuestas disponibles.
- Cada encuesta muestra sus preguntas y un botÃ³n â€œContestar encuestaâ€ que redirige a `/survey/:surveyId`.
- Desde esa vista puedes completar y enviar tus respuestas.
- La interfaz es simple, priorizando la funcionalidad por encima del diseÃ±o visual.
- TambiÃ©n puedes probar la vista de encuesta manualmente desde `/app` ingresando un ID vÃ¡lido.

### ğŸ” Seguridad
La app estÃ¡ diseÃ±ada para prevenir inyecciones SQL en los campos de entrada.


### ğŸ¨ Estilos
El archivo de estilos principal es `src/index.css`.

> Debido a que el SDK no compila directamente con Tailwind CSS, en esta app se usan estilos personalizados con CSS nativo.

Dentro de `index.css` encontrarÃ¡s un comentario explicando por quÃ© se optÃ³ por esta estrategia en lugar de usar Tailwind.

### ğŸ“¸ Pantallas
Vista principal con encuestas:

![Vista principal con encuestas](https://github.com/FernandoMejiaDev/Survey-Container/blob/main/Img-Readme/Readme-Image-1.png)

Vista de encuesta con campos para responder

![Vista de encuesta con campos para responder](https://github.com/FernandoMejiaDev/Survey-Container/blob/main/Img-Readme/Readme-Image-2.png)

</details>

<details>
<summary>ğŸ“‚ sdk</summary>

## ğŸ“¦ Â¿QuÃ© es `sdk`?

La carpeta `sdk` contiene el paquete reutilizable que expone el componente `SurveyWidget`, el cual permite integrar encuestas de forma sencilla en cualquier aplicaciÃ³n.  
Este SDK estÃ¡ hecho en **React** y **TypeScript**, y es el corazÃ³n de la funcionalidad para contestar encuestas conectadas al backend.


## âš™ï¸ TecnologÃ­as usadas

<div align="left">

![typescript](https://img.shields.io/static/v1?message=typescript&logo=typescript&label=&color=3178C6&logoColor=white&labelColor=&style=for-the-badge)
![react](https://img.shields.io/static/v1?message=react&logo=react&label=&color=61DAFB&logoColor=black&labelColor=&style=for-the-badge)

</div>

---

## ğŸš€ InstalaciÃ³n

Igual que en las otras carpetas, solo debes instalar las dependencias:

```
cd sdk
npm install
```

### ğŸ§± Estructura del SDK

```
/sdk
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ SurveyWidget.tsx â† Componente principal para mostrar y contestar encuestas
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts â† Tipos TypeScript para `Survey`, `Question` y `Response`
â”‚   â””â”€â”€ index.ts â† Punto de entrada del paquete que exporta el componente
â”‚
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json

```

### ğŸ§© Â¿QuÃ© hace SurveyWidget?

El componente `SurveyWidget` es un formulario dinÃ¡mico que:

- Recibe el ID de una encuesta como prop (`surveyId`).
- Hace una peticiÃ³n al backend para buscar la encuesta correspondiente.
- Muestra el tÃ­tulo y todas las preguntas asociadas a esa encuesta.
- Permite al usuario responder cada pregunta.
- Valida que no se envÃ­en campos vacÃ­os.
- EnvÃ­a las respuestas al endpoint `/api/responses` usando fetch.
- Muestra alertas al usuario dependiendo del Ã©xito o fallo de la operaciÃ³n.

AdemÃ¡s, este componente evita errores comunes como:

- Enviar respuestas incompletas.
- Dejar campos vacÃ­os.
- Perder el estado al cambiar de input.

### ğŸ§  Tipos definidos

Dentro de `src/types/index.ts` se definen las siguientes interfaces:

- `Survey`: Representa una encuesta con `id`, `text` y un array de `questions`.
- `Question`: Cada pregunta tiene un `id` y su `text`.
- `Response`: Representa la respuesta enviada a una pregunta (`questionId`, `content`).

### ğŸ“ ExportaciÃ³n del componente

El componente se exporta desde `src/index.ts` para poder importarlo directamente desde cualquier proyecto:

```
export { SurveyWidget } from './components/SurveyWidget';
```

Este SDK estÃ¡ diseÃ±ado para ser ligero, funcional y reutilizable, facilitando su integraciÃ³n en cualquier frontend compatible con React.

</details>

<details>
<summary>ğŸ“¡ API</summary>

## API

Este directorio contiene el cÃ³digo del **Backend de la aplicaciÃ³n**, desarrollado con **Node.js, Express, TypeScript**, y la base de datos **SQLite**, utilizando **Prisma** como ORM.

### ğŸ§© Â¿CÃ³mo funciona?
Al iniciar esta parte del proyecto, se levanta un servidor en `localhost:3000` donde podrÃ¡s interactuar con la API para crear y consultar encuestas.


### ğŸš€ Iniciar el servidor
Primero, asegÃºrate de haber instalado las dependencias:

```
cd backend
npm install
```

Luego, para ejecutar el servidor en modo desarrollo:

```
npm run dev
```

Al iniciar correctamente, deberÃ­as ver el siguiente mensaje en consola:
`API funcionando`

### ğŸ—ƒï¸ Base de datos
Al ejecutar el backend por primera vez, la base de datos ya debe estar creada (ver instrucciones en el apartado Backend). En este punto, estarÃ¡ vacÃ­a, por lo que al visitar la URL:

`http://localhost:3000/api/surveys`

`[]`

### ğŸ§ª Probar la API
Para agregar encuestas y probar el sistema, se recomienda utilizar **Postman**:

- Abre Postman y crea una nueva **peticiÃ³n POST**
- Usa como URL: `localhost:3000/api/surveys`
- Ve a la pestaÃ±a **Body**, selecciona **raw**, y elige **JSON** como tipo de contenido.
- Usa la siguiente plantilla de ejemplo para enviar tu encuesta:

```
{
  "qualification": "Nombre de la encuesta",
  "questions": [
    { "text": "Pregunta" },
    { "text": "Pregunta" }
  ]
}
```

> Puedes agregar la cantidad de preguntas que desees. El formato es flexible.

- Haz clic en **Send** y si todo estÃ¡ correcto, la encuesta se guardarÃ¡.
- Refresca la pÃ¡gina en tu navegador (`localhost:3000/api/surveys`) y ahora verÃ¡s la encuesta agregada en el array.

### ğŸ“Œ Notas adicionales
Si ya tienes abierto el local de `demo-app`, tambiÃ©n puedes refrescar la pÃ¡gina y verÃ¡s reflejada la nueva encuesta disponible para ser contestada desde el Front-End.

La API estÃ¡ preparada para recibir datos seguros y evitar inyecciones SQL mediante el uso de **Prisma ORM** y buenas prÃ¡cticas en los controladores.

</details>

<div align="left">

[![NPM](https://img.shields.io/static/v1?message=paquete-NPM&logo=NPM&label=&color=CD3E3D&logoColor=white&labelColor=&style=for-the-badge)](https://www.npmjs.com/package/survey-container)
[![GITHUB](https://img.shields.io/static/v1?message=Repositorio-de-demo-con-el-uso-del-paquete&logo=Github&label=&color=22262A&logoColor=white&labelColor=&style=for-the-badge)](https://github.com/FernandoMejiaDev/demo-survey-container)
[![WORDPRESS](https://img.shields.io/static/v1?message=pÃ¡gina-de-documentaciÃ³n&logo=WordPress&label=&color=1790c8&logoColor=white&labelColor=&style=for-the-badge)](https://surveycontainer.wordpress.com/)
</div>






